<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>pDOOM – XCOM / HF Geiger HUD</title>
<script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
<style>
  /* ── Dark‑metal HUD background ── */
  body{
    margin:0;
    background:#0a0a0a url('https://www.transparenttextures.com/patterns/brushed-alum.png');
    color:#e0e0e0;
    font-family:"Consolas",monospace;
    overflow:hidden;
  }
  #graph{width:100vw;height:90vh;position:relative;}
  /* ── Radar‑style grid ── */
  #grid{
    position:absolute; inset:0;
    background:
      repeating-linear-gradient(0deg,rgba(0,255,0,.02) 0,rgba(0,255,0,.02) 1px,transparent 1px,transparent 20px),
      repeating-linear-gradient(90deg,rgba(0,255,0,.02) 0,rgba(0,255,0,.02) 1px,transparent 1px,transparent 20px);
    mix-blend-mode:screen;
    pointer-events:none;
  }
  /* ── Scan line ── */
  #scan{
    position:absolute; inset:0;
    background:linear-gradient(90deg,transparent 0%,rgba(255,165,0,.15) 50%,transparent 100%);
    animation: sweep 4s linear infinite;
    pointer-events:none;
  }
  @keyframes sweep{
    0%{background-position:-100% 0;}
    100%{background-position:200% 0;}
  }
  /* ── Glitch overlay (amber) ── */
  #glitch{
    position:absolute; inset:0;
    background:linear-gradient(90deg,transparent 0%,rgba(255,165,0,.03) 50%,transparent 100%);
    mix-blend-mode:color-dodge;
    animation: glitch 3s infinite linear;
    pointer-events:none;
  }
  @keyframes glitch{
    0%{transform:translate(0,0);}
    20%{transform:translate(-2px,2px);}
    40%{transform:translate(2px,-2px);}
    60%{transform:translate(-1px,1px);}
    80%{transform:translate(1px,-1px);}
    100%{transform:translate(0,0);}
  }
  .control-panel{
    display:flex;flex-wrap:wrap;gap:1rem;padding:1rem;
    background:#111;
    border-top:2px solid #444;
  }
  .control-panel label{
    display:flex;flex-direction:column;font-size:.9rem;color:#a0ff7a;
  }
  input[type=range]{width:200px;}
  /* ── HUD‑style neon line ── */
  .glow{
    filter: drop-shadow(0 0 6px #ff0000) drop-shadow(0 0 12px #ff0000);
  }
</style>
</head>
<body>

<div id="graph">
  <div id="grid"></div>
  <div id="scan"></div>
  <div id="glitch"></div>
</div>

<div class="control-panel">
  <label>
    Exponent (b)
    <input type="range" id="expSlider" min="0.1" max="5" step="0.01" value="2">
  </label>

  <label>
    X‑offset (Δx)
    <input type="range" id="offsetSlider" min="-2" max="2" step="0.01" value="0">
  </label>

  <label>
    Top‑half shift (δ)
    <input type="range" id="shiftSlider" min="-2" max="2" step="0.01" value="0">
  </label>

  <label>
    Noise amplitude
    <input type="range" id="noiseSlider" min="0" max="0.05" step="0.001" value="0.01">
  </label>
</div>

<script>
/* -------------------------------------------------
   Math core – unchanged
   ------------------------------------------------- */
const expSlider   = document.getElementById('expSlider');
const offsetSlider= document.getElementById('offsetSlider');
const shiftSlider = document.getElementById('shiftSlider');
const noiseSlider = document.getElementById('noiseSlider');
const graphDiv    = document.getElementById('graph');

// Gaussian random (Box‑Muller)
function randGauss(){
  let u=0,v=0;
  while(u===0) u=Math.random();
  while(v===0) v=Math.random();
  return Math.sqrt(-2.0*Math.log(u))*Math.cos(2.0*Math.PI*v);
}

// C forces y(2027)=1
function computeC(b){ return 1 - Math.pow(2027,b); }

function generateData(){
  const b      = parseFloat(expSlider.value);
  const dx     = parseFloat(offsetSlider.value);
  const dTop   = parseFloat(shiftSlider.value);
  const noiseA = parseFloat(noiseSlider.value);
  const C      = computeC(b);

  const xs=[], ys=[];
  for(let yr=2020; yr<=2030; yr+=0.01){
    const x = yr + dx;
    let y = Math.pow(x,b) + C;
    y = Math.max(0, Math.min(1, y));
    if(y>0.5) y = Math.min(1, y + dTop);
    const noise = noiseA * randGauss();
    y = Math.max(0, Math.min(1, y + noise));
    xs.push(yr);
    ys.push(y);
  }
  return {x:xs, y:ys};
}

/* -------------------------------------------------
   Plotly rendering – HUD style
   ------------------------------------------------- */
function draw(){
  const data = generateData();

  const trace = {
    x: data.x,
    y: data.y,
    mode: 'lines',
    line: {
      width: 4,
      color: 'rgba(255,0,0,0.9)',   // red HUD line
      shape: 'spline'
    },
    hoverinfo: 'x+y',
    name: 'pDOOM'
  };

  const layout = {
    title: {
      text: '<b>pDOOM – PROBABILITY OF DOOM</b>',
      font: {color:'#ff6600',size:28},
      x:0.5
    },
    paper_bgcolor: '#0a0a0a',
    plot_bgcolor:  '#0a0a0a',
    xaxis: {
      title: {text:'Year',font:{color:'#a0ff7a'}},
      range: [2020,2030],
      tickfont:{color:'#a0ff7a'}
    },
    yaxis: {
      title: {text:'pDOOM (0 → 1)',font:{color:'#a0ff7a'}},
      range: [0,1],
      tickfont:{color:'#a0ff7a'}
    },
    margin:{l:60,r:20,b:60,t:80},
    font:{color:'#e0e0e0'},
    transition:{duration:300, easing:'cubic-in-out'}
  };

  Plotly.react(graphDiv, [trace], layout, {responsive:true});
}

/* -------------------------------------------------
   Slider listeners
   ------------------------------------------------- */
[expSlider, offsetSlider, shiftSlider, noiseSlider]
  .forEach(el=>el.addEventListener('input',draw));

draw();
</script>

</body>
</html>

